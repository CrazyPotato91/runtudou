{"remainingRequest":"/Users/chenzhe/blog/node_modules/babel-loader/lib/index.js??ref--3-1!/Users/chenzhe/blog/packages/theme-gungnir/utils/posts.js","dependencies":[{"path":"/Users/chenzhe/blog/packages/theme-gungnir/utils/posts.js","mtime":1630639090000},{"path":"/Users/chenzhe/blog/node_modules/cache-loader/dist/cjs.js","mtime":1632030570429},{"path":"/Users/chenzhe/blog/node_modules/babel-loader/lib/index.js","mtime":1623926664360}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIjsKaW1wb3J0IHsgZGF0ZUZvcm1hdCwgY29tcGFyZURhdGUgfSBmcm9tICJAdGhlbWUvdXRpbHMvdGltZSI7CmV4cG9ydCBmdW5jdGlvbiBnZXRQb3N0c0J5WWVhcihwYWdlcykgewogIHZhciBmb3JtYXRQYWdlcyA9IHt9OwogIHZhciBmb3JtYXRQYWdlc0FyciA9IFtdOwogIHBhZ2VzID0gZmlsdGVyUG9zdHMocGFnZXMsIHRydWUpOwoKICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gcGFnZXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgIHZhciBwYWdlID0gcGFnZXNbaV07CiAgICB2YXIgcGFnZURhdGVZZWFyID0gZGF0ZUZvcm1hdChwYWdlLmZyb250bWF0dGVyLmRhdGUsICJ5ZWFyIik7CiAgICBpZiAoZm9ybWF0UGFnZXNbcGFnZURhdGVZZWFyXSkgZm9ybWF0UGFnZXNbcGFnZURhdGVZZWFyXS5wdXNoKHBhZ2UpO2Vsc2UgewogICAgICBmb3JtYXRQYWdlc1twYWdlRGF0ZVllYXJdID0gW3BhZ2VdOwogICAgfQogIH0KCiAgZm9yICh2YXIga2V5IGluIGZvcm1hdFBhZ2VzKSB7CiAgICB2YXIgZGF0YSA9IGZvcm1hdFBhZ2VzW2tleV07CiAgICBzb3J0UG9zdHNCeURhdGUoZGF0YSk7CiAgICBmb3JtYXRQYWdlc0Fyci51bnNoaWZ0KHsKICAgICAgeWVhcjoga2V5LAogICAgICBkYXRhOiBkYXRhCiAgICB9KTsKICB9CgogIHJldHVybiBmb3JtYXRQYWdlc0FycjsKfQpleHBvcnQgZnVuY3Rpb24gZmlsdGVyUG9zdHMocG9zdHMsIGlzR3JvdXBlZEJ5WWVhcikgewogIHBvc3RzID0gcG9zdHMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgdmFyIHRpdGxlID0gaXRlbS50aXRsZSwKICAgICAgICBfaXRlbSRmcm9udG1hdHRlciA9IGl0ZW0uZnJvbnRtYXR0ZXIsCiAgICAgICAgaG9tZSA9IF9pdGVtJGZyb250bWF0dGVyLmhvbWUsCiAgICAgICAgZGF0ZSA9IF9pdGVtJGZyb250bWF0dGVyLmRhdGUsCiAgICAgICAgcHVibGlzaCA9IF9pdGVtJGZyb250bWF0dGVyLnB1Ymxpc2g7IC8vIGRlYWwgd2l0aCBkdXBsaWNhdGVkIHRhZ3MKCiAgICBpZiAocG9zdHMuaW5kZXhPZihpdGVtKSAhPT0gaW5kZXgpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgdmFyIHNvbWVDb25kaXRpb25zID0gaG9tZSA9PSB0cnVlIHx8IHRpdGxlID09IHVuZGVmaW5lZCB8fCBwdWJsaXNoID09PSBmYWxzZTsKICAgICAgdmFyIGJvbyA9IGlzR3JvdXBlZEJ5WWVhciA9PT0gdHJ1ZSA/ICEoc29tZUNvbmRpdGlvbnMgfHwgZGF0ZSA9PT0gdW5kZWZpbmVkKSA6ICFzb21lQ29uZGl0aW9uczsKICAgICAgcmV0dXJuIGJvbzsKICAgIH0KICB9KTsKICByZXR1cm4gcG9zdHM7Cn0KZXhwb3J0IGZ1bmN0aW9uIHNvcnRQb3N0c0J5RGF0ZShwb3N0cykgewogIHBvc3RzLnNvcnQoZnVuY3Rpb24gKHByZXYsIG5leHQpIHsKICAgIHJldHVybiBjb21wYXJlRGF0ZShwcmV2LCBuZXh0KTsKICB9KTsKfQ=="},{"version":3,"sources":["/Users/chenzhe/blog/packages/theme-gungnir/utils/posts.js"],"names":["dateFormat","compareDate","getPostsByYear","pages","formatPages","formatPagesArr","filterPosts","i","length","page","pageDateYear","frontmatter","date","push","key","data","sortPostsByDate","unshift","year","posts","isGroupedByYear","filter","item","index","title","home","publish","indexOf","someConditions","undefined","boo","sort","prev","next"],"mappings":";;;AAAA,SAASA,UAAT,EAAqBC,WAArB,QAAwC,mBAAxC;AAEA,OAAO,SAASC,cAAT,CAAwBC,KAAxB,EAA+B;AACpC,MAAMC,WAAW,GAAG,EAApB;AACA,MAAMC,cAAc,GAAG,EAAvB;AACAF,EAAAA,KAAK,GAAGG,WAAW,CAACH,KAAD,EAAQ,IAAR,CAAnB;;AAEA,OAAK,IAAII,CAAC,GAAG,CAAR,EAAWC,MAAM,GAAGL,KAAK,CAACK,MAA/B,EAAuCD,CAAC,GAAGC,MAA3C,EAAmDD,CAAC,EAApD,EAAwD;AACtD,QAAME,IAAI,GAAGN,KAAK,CAACI,CAAD,CAAlB;AACA,QAAMG,YAAY,GAAGV,UAAU,CAACS,IAAI,CAACE,WAAL,CAAiBC,IAAlB,EAAwB,MAAxB,CAA/B;AACA,QAAIR,WAAW,CAACM,YAAD,CAAf,EAA+BN,WAAW,CAACM,YAAD,CAAX,CAA0BG,IAA1B,CAA+BJ,IAA/B,EAA/B,KACK;AACHL,MAAAA,WAAW,CAACM,YAAD,CAAX,GAA4B,CAACD,IAAD,CAA5B;AACD;AACF;;AAED,OAAK,IAAMK,GAAX,IAAkBV,WAAlB,EAA+B;AAC7B,QAAMW,IAAI,GAAGX,WAAW,CAACU,GAAD,CAAxB;AACAE,IAAAA,eAAe,CAACD,IAAD,CAAf;AACAV,IAAAA,cAAc,CAACY,OAAf,CAAuB;AACrBC,MAAAA,IAAI,EAAEJ,GADe;AAErBC,MAAAA,IAAI,EAAJA;AAFqB,KAAvB;AAID;;AAED,SAAOV,cAAP;AACD;AAED,OAAO,SAASC,WAAT,CAAqBa,KAArB,EAA4BC,eAA5B,EAA6C;AAClDD,EAAAA,KAAK,GAAGA,KAAK,CAACE,MAAN,CAAa,UAACC,IAAD,EAAOC,KAAP,EAAiB;AAAA,QAElCC,KAFkC,GAIhCF,IAJgC,CAElCE,KAFkC;AAAA,4BAIhCF,IAJgC,CAGlCX,WAHkC;AAAA,QAGnBc,IAHmB,qBAGnBA,IAHmB;AAAA,QAGbb,IAHa,qBAGbA,IAHa;AAAA,QAGPc,OAHO,qBAGPA,OAHO,EAKpC;;AACA,QAAIP,KAAK,CAACQ,OAAN,CAAcL,IAAd,MAAwBC,KAA5B,EAAmC;AACjC,aAAO,KAAP;AACD,KAFD,MAEO;AACL,UAAMK,cAAc,GAClBH,IAAI,IAAI,IAAR,IAAgBD,KAAK,IAAIK,SAAzB,IAAsCH,OAAO,KAAK,KADpD;AAEA,UAAMI,GAAG,GACPV,eAAe,KAAK,IAApB,GACI,EAAEQ,cAAc,IAAIhB,IAAI,KAAKiB,SAA7B,CADJ,GAEI,CAACD,cAHP;AAIA,aAAOE,GAAP;AACD;AACF,GAjBO,CAAR;AAkBA,SAAOX,KAAP;AACD;AAED,OAAO,SAASH,eAAT,CAAyBG,KAAzB,EAAgC;AACrCA,EAAAA,KAAK,CAACY,IAAN,CAAW,UAACC,IAAD,EAAOC,IAAP,EAAgB;AACzB,WAAOhC,WAAW,CAAC+B,IAAD,EAAOC,IAAP,CAAlB;AACD,GAFD;AAGD","sourcesContent":["import { dateFormat, compareDate } from \"@theme/utils/time\";\n\nexport function getPostsByYear(pages) {\n  const formatPages = {};\n  const formatPagesArr = [];\n  pages = filterPosts(pages, true);\n\n  for (let i = 0, length = pages.length; i < length; i++) {\n    const page = pages[i];\n    const pageDateYear = dateFormat(page.frontmatter.date, \"year\");\n    if (formatPages[pageDateYear]) formatPages[pageDateYear].push(page);\n    else {\n      formatPages[pageDateYear] = [page];\n    }\n  }\n\n  for (const key in formatPages) {\n    const data = formatPages[key];\n    sortPostsByDate(data);\n    formatPagesArr.unshift({\n      year: key,\n      data\n    });\n  }\n\n  return formatPagesArr;\n}\n\nexport function filterPosts(posts, isGroupedByYear) {\n  posts = posts.filter((item, index) => {\n    const {\n      title,\n      frontmatter: { home, date, publish }\n    } = item;\n    // deal with duplicated tags\n    if (posts.indexOf(item) !== index) {\n      return false;\n    } else {\n      const someConditions =\n        home == true || title == undefined || publish === false;\n      const boo =\n        isGroupedByYear === true\n          ? !(someConditions || date === undefined)\n          : !someConditions;\n      return boo;\n    }\n  });\n  return posts;\n}\n\nexport function sortPostsByDate(posts) {\n  posts.sort((prev, next) => {\n    return compareDate(prev, next);\n  });\n}\n"]}]}